import {BaseService} from "../common/controllers/base.service";
import {Template} from "../models/Template";
import {ApplicationException} from "../common/exceptions";
import {compile, registerHelper, registerPartial} from 'handlebars';
import {TemplateRepository} from "../repositories/template.repository";
const moment = require("moment");

export class TemplateService extends BaseService<Template> {
    constructor(
        private readonly templateRepository: TemplateRepository<Template>
    ){
        super(templateRepository);
        this.helpersForTpl(); //Initialize helpers for tpl
    }

    helpersForTpl(){

        //Custom Date Format
        registerHelper('currency', function currencyFormat(number){
            if(!number){
                return "";
            }
            const numberFormat = new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP' });
            return numberFormat.format(number)
        });

        registerHelper('incrementDiscount', function (product, discount){
            if(!product){
                return "";
            } else if(discount <= 0){
                const numberFormat = new Intl.NumberFormat('es-CO', {minimumFractionDigits: 2});
                return numberFormat.format(Number(product.price));
            } else {
                const newPrice = (Number(product.price) * (discount || 0) / 100) + Number(product.price);
                const numberFormat = new Intl.NumberFormat('es-CO', {minimumFractionDigits: 2});
                return numberFormat.format(newPrice);
            }
        });

        registerHelper('scurrency', function currencyFormat(number){
            if(!number){
                return "";
            }
            const numberFormat = new Intl.NumberFormat('es-CO', {minimumFractionDigits: 2});
            return numberFormat.format(number)
        });

        //Custom dateFormat
        registerHelper('dateFormat', function (date, options) {
            const formatToUse = (arguments[1] && arguments[1].hash && arguments[1].hash.format) || "DD/MM/YYYY"
            return moment(date).format(formatToUse);
        });

        //Border Number
        registerHelper('borderNumber', function (borderNumber) {
            if((parseInt(borderNumber) % 4) >= 2){
                return "top";
            } else {
                return "bottom";
            }
        });

        //Border Number
        registerHelper('borderNumber', function (borderNumber) {
            if((parseInt(borderNumber) % 4) >= 2){
                return "top";
            } else {
                return "bottom";
            }
        });

        /** ############################ */
        /** Puede registrar aqui parciales que son plantillas usadas en el templates */
        /** Register Styles for can be used on templates */

        /** registerPartial(partialName, styleHTML) */

        registerPartial('printHeader', '<style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video { margin: 0; padding: 0; border: 0; line-height: 20px; font-family: monospace; vertical-align: baseline; font-size: 16px;}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section { display: block;}body { line-height: 1;}ol,ul { list-style: none;}blockquote,q { quotes: none;}blockquote:before,blockquote:after,q:before,q:after { content: \'\'\'\'; content: none;}table { border-collapse: collapse; border-spacing: 0;}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary { display: block;}body { width: 100%;}.wrapper { width: 670px; margin: 0 auto; page-break-after: always;}.header { margin-bottom: 25px;}.order_info { width: 270px; float: left; height: 70px; text-align: center;}.order_info p { line-height: 18px; font-size: 0.9em; vertical-align: middle;}.logo { width: 400px; height: 70px; float: left;}.logo span { font-size: 1.5em; color: red; line-height: 34px; vertical-align: middle; display: inline-block;}.logo svg { line-height: 54px; vertical-align: middle; display: inline-block;}.client_info { width: 100%; margin-bottom: 8px; border-bottom: solid 1px #000;}.client_info2 { padding-top: 15px;}.client_info2 table { width: 100%;}.client_info2 table td { border: solid 1px lightgray;}.envio { font-size: 24px; font-weight: bold; color: red;}.content {}.content table { width: 100%;}.content table thead { font-weight: bold;}.content table tbody tr { border-top-width: thin; border-top-style: solid; border-top-color: black;}.content table tbody tr td { font-size: 1.3em; padding: 2px;}.mas_de_uno { background: #dfdfdf;}.footer { height: 50px;}.imprimir { margin-top: 20px; width: 350px; float: left; text-align: center;}.imprimir button { font-size: 20px;}.order_total { margin-top: 20px; width: 320px; float: left;}</style>');
        registerPartial('catalogHeader', '<style>html{-webkit-print-color-adjust:exact}.col .row{margin-left:-.75rem;margin-right:-.75rem}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:"";display:table;clear:both}.row .col{float:left;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col[class*=pull-],.row .col[class*=push-]{position:relative}.row .col.s1{width:8.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.s2{width:16.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.s3{width:25%;margin-left:auto;left:auto;right:auto}.row .col.s4{width:33.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.s5{width:41.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.s6{width:50%;margin-left:auto;left:auto;right:auto}.row .col.s7{width:58.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.s8{width:66.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.s9{width:75%;margin-left:auto;left:auto;right:auto}.row .col.s10{width:83.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.s11{width:91.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}.row .col.offset-s1{margin-left:8.3333333333%}.row .col.pull-s1{right:8.3333333333%}.row .col.push-s1{left:8.3333333333%}.row .col.offset-s2{margin-left:16.6666666667%}.row .col.pull-s2{right:16.6666666667%}.row .col.push-s2{left:16.6666666667%}.row .col.offset-s3{margin-left:25%}.row .col.pull-s3{right:25%}.row .col.push-s3{left:25%}.row .col.offset-s4{margin-left:33.3333333333%}.row .col.pull-s4{right:33.3333333333%}.row .col.push-s4{left:33.3333333333%}.row .col.offset-s5{margin-left:41.6666666667%}.row .col.pull-s5{right:41.6666666667%}.row .col.push-s5{left:41.6666666667%}.row .col.offset-s6{margin-left:50%}.row .col.pull-s6{right:50%}.row .col.push-s6{left:50%}.row .col.offset-s7{margin-left:58.3333333333%}.row .col.pull-s7{right:58.3333333333%}.row .col.push-s7{left:58.3333333333%}.row .col.offset-s8{margin-left:66.6666666667%}.row .col.pull-s8{right:66.6666666667%}.row .col.push-s8{left:66.6666666667%}.row .col.offset-s9{margin-left:75%}.row .col.pull-s9{right:75%}.row .col.push-s9{left:75%}.row .col.offset-s10{margin-left:83.3333333333%}.row .col.pull-s10{right:83.3333333333%}.row .col.push-s10{left:83.3333333333%}.row .col.offset-s11{margin-left:91.6666666667%}.row .col.pull-s11{right:91.6666666667%}.row .col.push-s11{left:91.6666666667%}.row .col.offset-s12{margin-left:100%}.row .col.pull-s12{right:100%}.row .col.push-s12{left:100%}@media only screen and (min-width:601px){.row .col.m1{width:8.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.m2{width:16.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.m3{width:25%;margin-left:auto;left:auto;right:auto}.row .col.m4{width:33.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.m5{width:41.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}.row .col.m7{width:58.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.m8{width:66.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.m9{width:75%;margin-left:auto;left:auto;right:auto}.row .col.m10{width:83.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.m11{width:91.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.m12{width:100%;margin-left:auto;left:auto;right:auto}.row .col.offset-m1{margin-left:8.3333333333%}.row .col.pull-m1{right:8.3333333333%}.row .col.push-m1{left:8.3333333333%}.row .col.offset-m2{margin-left:16.6666666667%}.row .col.pull-m2{right:16.6666666667%}.row .col.push-m2{left:16.6666666667%}.row .col.offset-m3{margin-left:25%}.row .col.pull-m3{right:25%}.row .col.push-m3{left:25%}.row .col.offset-m4{margin-left:33.3333333333%}.row .col.pull-m4{right:33.3333333333%}.row .col.push-m4{left:33.3333333333%}.row .col.offset-m5{margin-left:41.6666666667%}.row .col.pull-m5{right:41.6666666667%}.row .col.push-m5{left:41.6666666667%}.row .col.offset-m6{margin-left:50%}.row .col.pull-m6{right:50%}.row .col.push-m6{left:50%}.row .col.offset-m7{margin-left:58.3333333333%}.row .col.pull-m7{right:58.3333333333%}.row .col.push-m7{left:58.3333333333%}.row .col.offset-m8{margin-left:66.6666666667%}.row .col.pull-m8{right:66.6666666667%}.row .col.push-m8{left:66.6666666667%}.row .col.offset-m9{margin-left:75%}.row .col.pull-m9{right:75%}.row .col.push-m9{left:75%}.row .col.offset-m10{margin-left:83.3333333333%}.row .col.pull-m10{right:83.3333333333%}.row .col.push-m10{left:83.3333333333%}.row .col.offset-m11{margin-left:91.6666666667%}.row .col.pull-m11{right:91.6666666667%}.row .col.push-m11{left:91.6666666667%}.row .col.offset-m12{margin-left:100%}.row .col.pull-m12{right:100%}.row .col.push-m12{left:100%}}@media only screen and (min-width:993px){.row .col.l1{width:8.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.l2{width:16.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.l3{width:25%;margin-left:auto;left:auto;right:auto}.row .col.l4{width:33.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.l5{width:41.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.l6{width:50%;margin-left:auto;left:auto;right:auto}.row .col.l7{width:58.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.l8{width:66.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.l9{width:75%;margin-left:auto;left:auto;right:auto}.row .col.l10{width:83.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.l11{width:91.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.l12{width:100%;margin-left:auto;left:auto;right:auto}.row .col.offset-l1{margin-left:8.3333333333%}.row .col.pull-l1{right:8.3333333333%}.row .col.push-l1{left:8.3333333333%}.row .col.offset-l2{margin-left:16.6666666667%}.row .col.pull-l2{right:16.6666666667%}.row .col.push-l2{left:16.6666666667%}.row .col.offset-l3{margin-left:25%}.row .col.pull-l3{right:25%}.row .col.push-l3{left:25%}.row .col.offset-l4{margin-left:33.3333333333%}.row .col.pull-l4{right:33.3333333333%}.row .col.push-l4{left:33.3333333333%}.row .col.offset-l5{margin-left:41.6666666667%}.row .col.pull-l5{right:41.6666666667%}.row .col.push-l5{left:41.6666666667%}.row .col.offset-l6{margin-left:50%}.row .col.pull-l6{right:50%}.row .col.push-l6{left:50%}.row .col.offset-l7{margin-left:58.3333333333%}.row .col.pull-l7{right:58.3333333333%}.row .col.push-l7{left:58.3333333333%}.row .col.offset-l8{margin-left:66.6666666667%}.row .col.pull-l8{right:66.6666666667%}.row .col.push-l8{left:66.6666666667%}.row .col.offset-l9{margin-left:75%}.row .col.pull-l9{right:75%}.row .col.push-l9{left:75%}.row .col.offset-l10{margin-left:83.3333333333%}.row .col.pull-l10{right:83.3333333333%}.row .col.push-l10{left:83.3333333333%}.row .col.offset-l11{margin-left:91.6666666667%}.row .col.pull-l11{right:91.6666666667%}.row .col.push-l11{left:91.6666666667%}.row .col.offset-l12{margin-left:100%}.row .col.pull-l12{right:100%}.row .col.push-l12{left:100%}}@media only screen and (min-width:1201px){.row .col.xl1{width:8.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.xl2{width:16.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.xl3{width:25%;margin-left:auto;left:auto;right:auto}.row .col.xl4{width:33.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.xl5{width:41.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.xl6{width:50%;margin-left:auto;left:auto;right:auto}.row .col.xl7{width:58.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.xl8{width:66.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.xl9{width:75%;margin-left:auto;left:auto;right:auto}.row .col.xl10{width:83.3333333333%;margin-left:auto;left:auto;right:auto}.row .col.xl11{width:91.6666666667%;margin-left:auto;left:auto;right:auto}.row .col.xl12{width:100%;margin-left:auto;left:auto;right:auto}.row .col.offset-xl1{margin-left:8.3333333333%}.row .col.pull-xl1{right:8.3333333333%}.row .col.push-xl1{left:8.3333333333%}.row .col.offset-xl2{margin-left:16.6666666667%}.row .col.pull-xl2{right:16.6666666667%}.row .col.push-xl2{left:16.6666666667%}.row .col.offset-xl3{margin-left:25%}.row .col.pull-xl3{right:25%}.row .col.push-xl3{left:25%}.row .col.offset-xl4{margin-left:33.3333333333%}.row .col.pull-xl4{right:33.3333333333%}.row .col.push-xl4{left:33.3333333333%}.row .col.offset-xl5{margin-left:41.6666666667%}.row .col.pull-xl5{right:41.6666666667%}.row .col.push-xl5{left:41.6666666667%}.row .col.offset-xl6{margin-left:50%}.row .col.pull-xl6{right:50%}.row .col.push-xl6{left:50%}.row .col.offset-xl7{margin-left:58.3333333333%}.row .col.pull-xl7{right:58.3333333333%}.row .col.push-xl7{left:58.3333333333%}.row .col.offset-xl8{margin-left:66.6666666667%}.row .col.pull-xl8{right:66.6666666667%}.row .col.push-xl8{left:66.6666666667%}.row .col.offset-xl9{margin-left:75%}.row .col.pull-xl9{right:75%}.row .col.push-xl9{left:75%}.row .col.offset-xl10{margin-left:83.3333333333%}.row .col.pull-xl10{right:83.3333333333%}.row .col.push-xl10{left:83.3333333333%}.row .col.offset-xl11{margin-left:91.6666666667%}.row .col.pull-xl11{right:91.6666666667%}.row .col.push-xl11{left:91.6666666667%}.row .col.offset-xl12{margin-left:100%}.row .col.pull-xl12{right:100%}.row .col.push-xl12{left:100%}}.btn,.btn-floating,.btn-large,.btn-small,.card,.card-panel,.collapsible,.dropdown-content,.sidenav,.toast,.z-depth-1,nav{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.12),0 1px 5px 0 rgba(0,0,0,.2)}.card-panel{transition:box-shadow .25s;padding:24px;margin:.5rem 0 1rem 0;border-radius:2px;background-color:#fff}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;transition:box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card.large,.card.medium,.card.small{position:relative}.card.large .card-image,.card.medium .card-image,.card.small .card-image{max-height:60%;overflow:hidden}.card.large .card-image+.card-content,.card.medium .card-image+.card-content,.card.small .card-image+.card-content{max-height:40%}.card.large .card-content,.card.medium .card-content,.card.small .card-content{max-height:100%;overflow:hidden}.card.large .card-action,.card.medium .card-action,.card.small .card-action{position:absolute;bottom:0;left:0;right:0}.card.small{height:300px}.card.medium{height:400px}.card.large{height:500px}.card.horizontal{display:flex}.card.horizontal.large .card-image,.card.horizontal.medium .card-image,.card.horizontal.small .card-image{height:100%;max-height:none;overflow:visible}.card.horizontal.large .card-image img,.card.horizontal.medium .card-image img,.card.horizontal.small .card-image img{height:100%}.card.horizontal .card-image{max-width:50%}.card.horizontal .card-image img{border-radius:2px 0 0 2px;max-width:100%;width:auto}.card.horizontal .card-stacked{display:flex;flex-direction:column;flex:1;position:relative}.card.horizontal .card-stacked .card-content{flex-grow:1}.card.sticky-action .card-action{z-index:2}.card.sticky-action .card-reveal{z-index:1;padding-bottom:64px}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-image .card-title{color:#fff;position:absolute;bottom:0;left:0;max-width:100%;padding:24px}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-action{background-color:inherit;border-top:1px solid rgba(160,160,160,.2);position:relative;padding:16px 24px}.card .card-action:last-child{border-radius:0 0 2px 2px}.card .card-action a:not(.btn):not(.btn-large):not(.btn-small):not(.btn-large):not(.btn-floating){color:#ffab40;margin-right:24px;transition:color .3s ease;text-transform:uppercase}.card .card-action a:not(.btn):not(.btn-large):not(.btn-small):not(.btn-large):not(.btn-floating):hover{color:#ffd8a6}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.card.categoria-lista{cursor:pointer}.card.producto-lista{cursor:pointer}.card.producto-lista .card-image{position:relative}.card.producto-lista .card-image:before{content:"";padding-top:150%;display:block}.card.producto-lista .card-image img{position:absolute;top:0;left:0}.card.producto-lista .card-image .ver-detalles{background-color:rgba(0,0,0,.5);position:absolute;top:0;left:0;width:100%;height:100%;z-index:9;text-align:center;padding:55% 10%;display:none}.card.producto-lista .card-image .ver-detalles span{display:flex;flex-direction:column;justify-content:center;width:100%;height:100%;border:solid #fff 1px;color:#fff;font-size:20px}.card.producto-lista .card-image .estrella{position:absolute;top:5px;right:5px}.card.producto-lista .card-image .estrella i{font-size:48px;color:#df9600}.card.producto-lista .card-image .descuento{position:absolute;background-color:#424242;color:#fff;width:100%;bottom:0;z-index:8;text-align:center;font-size:16px;padding:2px 0}.card.producto-lista .card-content{padding:24px 8px}.card.producto-lista .card-content .precio{font-size:16px;text-align:center}.card.producto-lista .card-content .precio cite{text-decoration:line-through;color:#bdbdbd;margin:0 5px}@media only screen and (max-width:600px){.card.producto-lista .card-content .precio cite{font-size:12px}}.card.producto-lista .card-content .precio b{color:#bf004c;text-align:right;margin:0 5px}.card.producto-lista .card-title.codigo{line-height:1.5rem;font-weight:400;text-align:center}.card.producto-lista .card-title.codigo label{font-size:18px}.card.producto-lista .card-title.codigo b{font-size:20px}.card.producto-lista:hover .ver-detalles{display:block}.card.producto-lista-pdf{margin:4px 0}.card.producto-lista-pdf .card-image{position:relative}.card.producto-lista-pdf .card-image .marca-agua{font-size:.7em;position:absolute;bottom:5px;right:5px;font-weight:700;opacity:.15}.card.producto-lista-pdf .card-image .estrella{position:absolute;top:5px;right:5px}.card.producto-lista-pdf .card-content{padding:2px 0}.card.producto-lista-pdf .card-content div{margin:2px 0}.card.producto-lista-pdf .card-content .precio{font-size:16px;text-align:center}.card.producto-lista-pdf .card-content .precio cite{text-decoration:line-through;color:#bdbdbd;margin:0 5px}@media only screen and (max-width:600px){.card.producto-lista-pdf .card-content .precio cite{font-size:12px}}.card.producto-lista-pdf .card-content .precio b{color:#bf004c;text-align:right;margin:0 5px}.card.producto-lista-pdf .card-content .material{text-align:center;color:#424242;font-size:12px}.card.producto-lista-pdf .card-content .tallas{text-align:center}.card.producto-lista-pdf .card-title{margin:0}.card.producto-lista-pdf .card-title.codigo{line-height:1.5rem;font-weight:400;text-align:center}.card.producto-lista-pdf .card-title.codigo label{font-size:18px}.card.producto-lista-pdf .card-title.codigo b{font-size:20px}.card.producto-lista-pdf-nuevo{margin:4px 0}.card.producto-lista-pdf-nuevo .card-image{position:relative}.card.producto-lista-pdf-nuevo .card-image .marca-agua{font-size:.7em;position:absolute;bottom:5px;right:5px;font-weight:700;opacity:.15}.card.producto-lista-pdf-nuevo .card-image .estrella{position:absolute;top:5px;right:5px}.card.producto-lista-pdf-nuevo .card-image .card-description{font-family:\'Century Gothic\',Futura,sans-serif;padding:2px 0;position:absolute;bottom:0;left:0;width:100%;height:58px;background-color:rgba(0,0,0,.5);color:#fff;font-size:16px;font-weight:700}.card.producto-lista-pdf-nuevo .card-image .card-description .col{height:24px;line-height:24px;margin:2px 0;vertical-align:middle}.card.producto-lista-pdf-nuevo .card-image .card-description .precio{padding-right:0}.card.producto-lista-pdf-nuevo .card-image .card-description .codigo{padding-right:0}.card.producto-lista-pdf-nuevo .card-image .card-description .talla{padding-left:0}.card.producto-lista-pdf-nuevo .card-image .card-description .talla span{font-size:12px}.card.producto-lista-pdf-nuevo .card-image .card-description .material{padding-left:0}.card.producto-lista-pdf-nuevo .card-image .card-description .material span{display:inline-block;width:calc(100% - 50px);font-size:12px}.card.producto-lista-pdf-nuevo .card-image .card-description img{display:inline-block;width:40px;height:24px;margin-left:2px;line-height:24px;vertical-align:top}.card.testimonio i{color:#df9600}.rounded{display:inline-block;height:32px;font-size:13px;font-weight:500;color:#000;line-height:32px;padding:0 12px;border-radius:16px;background-color:#e4e4e4;margin-bottom:5px;margin-right:5px}@media print{.rounded{background-color:#e4e4e4}} body{width: 670px;margin: auto;}.card-image{position: relative;}.mini {position: absolute;left: 0;bottom: 0;}.mini img{width: 150px;}@media print {.row{page-break-before: always;}}</style>');

        /** Fin de Registro de Parciales */
        /** ############################ */

    }

    /**
     * Obtener una plantilla determinada
     * @param templateName - Nombre de la Plantilla
     * @param dataObject - Objeto o Arreglo para interpolación en plantilla
     */
    async getTemplate(templateName, dataObject: Object){

        try {
            const template = await this.templateRepository.findOneByObject({reference: templateName});
            if(template){
                return compile(template.template)({...dataObject});
            } else {
                throw new ApplicationException("No se ha encontrado plantilla - " + templateName);
            }
        }catch(e){
            console.log("error generado", e.message);
            throw new ApplicationException("Ha ocurrido un problema con la plantilla - " + templateName);
        }
    }
}
